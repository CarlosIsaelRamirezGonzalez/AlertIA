{% extends "base.html" %}
{% block title %}AlertAI - {% if edit_mode %}Edit{% else %}Add{% endif %} Camera{% endblock %}

{% block page_content %}
<section class="add-camera">

    <div class="add-camera-popup">
        <i class="fa-solid fa-xmark add-camera-popup-icon" id="close-camera-popup"></i>

        <div class="add-camera-popup-container-map">
            <input type="text" placeholder="Enter the ubication" class="add-camera-popup-map-input" id="place_input" >
            <button class="add-camera-popup-map-buttton">Register</button>
            <div id="map" class="add-camera-popup-map"></div>
        </div>


    </div>

    <form method="post" class="add-camera-form" {% if edit_mode %} action="{{ url_for('home.edit_camera', camera_id=camera.id) }}"{% endif %}>
        {{ form.csrf_token }}

        <div class="add-camera-form-left-side">
        
            <h1 class="add-camera-form-title">Camera Information</h1>

            <i class="fa-solid fa-pencil add-camera-icon"></i>
            {{ form.name(class='add-camera-input', placeholder="Camera Name", autoComplete="off") }}

            <i class="fa-solid fa-phone add-camera-icon"></i>
            {{ form.phone_number(class='add-camera-input', placeholder="Phone Number", maxlength="10", autoComplete="off") }}

            <i class="fa-solid fa-location-dot add-camera-icon"></i>
            {{ form.address(placeholder="Location Camera", class="add-camera-input", autoComplete="off")  }}

        </div>
        
        <div class="add-camera-form-right-side">

            <h1 class="add-camera-form-title">Camera Configuration</h1>

            <div class="add-camera-type-camera">
                <h3 class="add-camera-type-camera-question">What type of camera do you want to enter?</h3>
                <br>   
                <label class="add-camera-type-camera-selection">
                    <input type="radio" name="{{ form.camera_type.name }}" value="WebCamera" id="WebCamera"> Web Camera
                </label>
                <br>
                <label class="add-camera-type-camera-selection">
                    <input type="radio" name="{{ form.camera_type.name }}" value="SecurityCamera" id="SecurityCamera"> Security Camera 
                </label>
            </div>
            <br>

            <!-- Añadir el campo select para mostrar las cámaras web disponibles -->
            <div class="add-camera-webcam-selection" id="webcam-selection" style="display: none;">
                <h3 class="add-camera-webcam-question">Select the web camera you want to use</h3>
                {{ form.device_id(class='add-camera-input') }}
            </div>

            {{ form.url(placeholder="URL camera", class='add-camera-input', autoComplete="off")  }}
            
            {{ form.place(class="add-camera-alert-select", id="place-select") }}

        
            <h2 class="add-camera-type-camera-question" id="personalized-alert-title">Types of alerts you would like to be notified of</h2>
        
            <div class="add-camera-alerts" id="personalized-alert">
                
            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Fires</h3> 
                <i class="fa-solid fa-house-fire add-camera-icon-alert"></i>
                {{ form.fires(type="checkbox", **{'title':"This alert is specifically for fires, home fires, forest fires, gas station fires, and others"}) }}
            </label>
            


            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Bladed weapons</h3>
                <i class="fa-solid fa-wand-sparkles add-camera-icon-alert"></i>
                {{ form.bladed_weapon(type="checkbox", title='This alert is bladed weapons like knifes, axes, machetes, katanas and razors') }}
            </label>



            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Hand Gun</h3>
                <i class="fa-solid fa-gun add-camera-icon-alert"></i>
                {{ form.handgun(type="checkbox", title='This alert is for fire guns, specially for short fire guns, like revolvers') }}
            </label>


            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Long Gun</h3>
                <i class="fa-solid fa-gun add-camera-icon-alert"></i>
                {{ form.long_gun(type="checkbox", title='This alert is for fire guns, specially for long guns, like ak-47, and others') }}
            </label>

            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Cannoning</h3>
                <i class="fa-solid fa-people-robbery add-camera-icon-alert"></i>
                {{ form.cannoning(type="checkbox", **{'title': "This alert works when a person pointed a fire gun to other person, doesn't matter if is a long fire gun or a short fire gun"}) }}
            </label>

            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Car Accident</h3>
                <i class="fa-solid fa-car-burst add-camera-icon-alert"></i>
                {{ form.car_accident(type="checkbox", title='This alert works when one or more cars crashed, doesn't matter with what it crashed, only matter that it crashed') }}               
            </label>

            <label class="add-camera-alert-container">
                <h3 class="add-camera-alert-name">Dog Atack</h3>
                <i class="fa-solid fa-paw add-camera-icon-alert"></i>
                {{ form.dog_attack(type="checkbox", title='This alert works when a dog atack to a person or a other dog') }}
            </label>

            <label class="add-camera-alert-container">                  
                <h3 class="add-camera-alert-name">Brawls</h3>
                <i class="fa-solid fa-user-ninja add-camera-icon-alert"></i>
                {{ form.brawls(type="checkbox", title='This alert works when two people fight, only works when they hit, kick, or struggle') }}            
            </label>

            <label class="add-camera-alert-container">                    
                <h3 class="add-camera-alert-name">Injured People</h3>
                <i class="fa-solid fa-person-falling-burst add-camera-icon-alert"></i>
                {{ form.injured_people(type="checkbox", title='This alert works when a person has exposed wounds, whether partial or total amputations of their body, prominent bleeding, or an opening in their skin where blood oozes') }}                
            </label>
        </div> 
        
        <div class="add-camera-form-bottom-side">
            <button class="add-camera-form-button" type="submit">
                {% if edit_mode %} Update {% else %} Save {% endif %}
            </button>
        </div>

    </form>

</section>
<script src="js/googleMap.js"></script>
<script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHOslXEWFjWLvxr2EPcxER3QC44_T1sgY&libraries=places&callback=initMap"></script>
<script src="{{ url_for('static', filename='Js/addCameraDOM.js') }}"></script>
<script src="{{ url_for('static', filename='Js/googleMapPopup.js') }}"></script>
<script src="{{ url_for('static', filename='Js/googleMapService.js') }}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const webCameraRadio = document.getElementById('WebCamera');
        const securityCameraRadio = document.getElementById('SecurityCamera');
        const webcamSelection = document.getElementById('webcam-selection');

        function toggleWebcamSelection() {
            if (webCameraRadio.checked) {
                webcamSelection.style.display = 'block';
            } else {
                webcamSelection.style.display = 'none';
            }
        }

        webCameraRadio.addEventListener('change', toggleWebcamSelection);
        securityCameraRadio.addEventListener('change', toggleWebcamSelection);

        toggleWebcamSelection(); // Run on page load in case Web Camera is already selected
    });
</script>

{% endblock page_content %}

